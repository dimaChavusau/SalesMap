<!-- salesMapFilters.html -->
<template>
    <article class="slds-card">
        <div class="slds-card__header slds-grid">
            <header class="slds-media slds-media_center slds-has-flexi-truncate">
                <div class="slds-media__body">
                    <h2 class="slds-card__header-title">
                        <span>Filters</span>
                    </h2>
                </div>
            </header>
            <div class="slds-no-flex">
                <a href="/lightning/r/ContentDocument/0691p0000074OSjAAM/view" 
                   target="_blank" 
                   class="slds-text-link">
                    Help & Guide
                </a>
            </div>
        </div>
        
        <div class="slds-card__body slds-card__body_inner">
            <!-- Action Buttons -->
            <div class="slds-grid slds-gutters_x-small slds-m-bottom_small">
                <div class="slds-col">
                    <lightning-button 
                        label="Search" 
                        variant="brand" 
                        onclick={handleSearch} 
                        class="slds-size_1-of-1">
                    </lightning-button>
                </div>
                <div class="slds-col">
                    <lightning-button 
                        label="Reset" 
                        onclick={handleReset} 
                        class="slds-size_1-of-1">
                    </lightning-button>
                </div>
            </div>
            
            <!-- Main Accounts Checkbox -->
            <div class="slds-m-bottom_small">
                <lightning-input
                    type="checkbox"
                    label="Only main accounts"
                    checked={onlyMainAccounts}
                    onchange={handleMainAccountChange}>
                </lightning-input>
            </div>
            
            <!-- Filters Accordion -->
            <lightning-accordion active-section-name={activeSections} 
                               allow-multiple-sections-open>
                
                <!-- Search Section -->
                <lightning-accordion-section name="search" label="Search">
                    <lightning-input 
                        type="search" 
                        placeholder="Search accounts..." 
                        value={searchTerm}
                        variant="label-hidden"
                        oninput={handleSearchTermInput}>
                    </lightning-input>
                </lightning-accordion-section>
                
                <!-- Location Section -->
                <lightning-accordion-section name="location" label="Location">
                    <c-location-search-input-lwc
                        search-value={location}
                        onselectlocation={handleLocationSelect}>
                    </c-location-search-input-lwc>
                    
                    <div class="slds-grid slds-gutters_x-small slds-m-top_x-small">
                        <div class="slds-col slds-size_2-of-3">
                            <lightning-input 
                                type="number" 
                                label="Radius" 
                                value={radius}
                                field-level-help="Search radius"
                                oninput={handleRadiusInput}>
                            </lightning-input>
                        </div>
                        <div class="slds-col slds-size_1-of-3">
                            <lightning-combobox 
                                label="Unit" 
                                value={unit} 
                                options={unitOptions}
                                onchange={handleUnitChange}>
                            </lightning-combobox>
                        </div>
                    </div>
                </lightning-accordion-section>
                
                <!-- Territories Section -->
                <lightning-accordion-section name="territories" label="Territories">
                    <c-multi-select-lookup-lwc
                        object-api-name="Territory__c"
                        placeholder="Search territories..."
                        icon-name="standard:service_territory"
                        fields="Code__c"
                        conditions={territoryConditions}
                        selected-records={selectedTerritories}
                        onselectionchange={handleTerritoryChange}>
                    </c-multi-select-lookup-lwc>
                </lightning-accordion-section>
                
                <!-- Trainers Section -->
                <lightning-accordion-section name="trainers" label="Trainers">
                    <c-multi-select-lookup-lwc
                        object-api-name="User"
                        placeholder="Search trainers..."
                        icon-name="standard:user"
                        conditions={trainerConditions}
                        selected-records={selectedTrainers}
                        onselectionchange={handleTrainerChange}>
                    </c-multi-select-lookup-lwc>
                </lightning-accordion-section>
                
                <!-- Campaigns Section -->
                <lightning-accordion-section name="campaigns" label="Campaigns">
                    <c-multi-select-lookup-lwc
                        object-api-name="Campaign"
                        placeholder="Search campaigns..."
                        icon-name="standard:campaign"
                        selected-records={selectedCampaigns}
                        onselectionchange={handleCampaignChange}>
                    </c-multi-select-lookup-lwc>
                </lightning-accordion-section>
                
                <!-- Brands Section (US Only) -->
                <template if:true={showBrands}>
                    <lightning-accordion-section name="brands" label="Brands">
                        <lightning-dual-listbox
                            name="brands"
                            source-label="Available"
                            selected-label="Selected"
                            options={brandOptions}
                            value={selectedBrands}
                            size="4"
                            onchange={handleBrandChange}>
                        </lightning-dual-listbox>
                    </lightning-accordion-section>
                </template>
                
                <!-- Legal Hierarchies Section -->
                <lightning-accordion-section name="legalHierarchies" label="Legal Hierarchies">
                    <lightning-dual-listbox
                        name="legalHierarchies"
                        source-label="Available"
                        selected-label="Selected"
                        options={legalHierarchyOptions}
                        value={selectedLegalHierarchyIds}
                        size="5"
                        onchange={handleLegalHierarchyChange}>
                    </lightning-dual-listbox>
                </lightning-accordion-section>
                
                <!-- Business Hierarchies Section -->
                <lightning-accordion-section name="businessHierarchies" label="Business Hierarchies">
                    <lightning-dual-listbox
                        name="businessHierarchies"
                        source-label="Available"
                        selected-label="Selected"
                        options={businessHierarchyOptions}
                        value={selectedBusinessHierarchyIds}
                        size="5"
                        onchange={handleBusinessHierarchyChange}>
                    </lightning-dual-listbox>
                </lightning-accordion-section>
                
                <!-- Distribution Channel Section -->
                <lightning-accordion-section name="distributionChannel" label="Distribution Channel">
                    <lightning-dual-listbox
                        name="distributionChannel"
                        source-label="Available"
                        selected-label="Selected"
                        options={distributionChannelOptions}
                        value={selectedDistributionChannels}
                        size="4"
                        onchange={handleDistributionChannelChange}>
                    </lightning-dual-listbox>
                </lightning-accordion-section>
                
                <!-- Account Status Section -->
                <lightning-accordion-section name="accountStatus" label="Account Status">
                    <lightning-dual-listbox
                        name="accountStatus"
                        source-label="Available"
                        selected-label="Selected"
                        options={accountStatusOptions}
                        value={selectedAccountStatus}
                        size="4"
                        onchange={handleAccountStatusChange}>
                    </lightning-dual-listbox>
                </lightning-accordion-section>
                
                <!-- Merchant Status Section (Germany Only) -->
                <template if:true={showMerchantStatusFilter}>
                    <lightning-accordion-section name="merchantStatus" label="Merchant Status">
                        <lightning-dual-listbox
                            name="merchantStatus"
                            source-label="Available"
                            selected-label="Selected"
                            options={merchantStatusOptions}
                            value={selectedMerchantStatus}
                            size="4"
                            onchange={handleMerchantStatusChange}>
                        </lightning-dual-listbox>
                    </lightning-accordion-section>
                </template>
                
                <!-- Visits & Trainings Section -->
                <lightning-accordion-section name="visitsTrainings" label="Visits & Trainings">
                    <div class="slds-m-bottom_small">
                        <lightning-input
                            type="checkbox"
                            label="Exclude Do Not Visit"
                            checked={excludeDoNotVisit}
                            onchange={handleExcludeDoNotVisitChange}>
                        </lightning-input>
                    </div>
                    <lightning-combobox
                        label="Sales Target Filter"
                        value={salesTargetFilter}
                        options={salesTargetOptions}
                        placeholder="Select option"
                        onchange={handleSalesTargetChange}>
                    </lightning-combobox>
                </lightning-accordion-section>
            </lightning-accordion>
            
            <!-- Bottom Action Buttons -->
            <div class="slds-grid slds-gutters_x-small slds-m-top_medium slds-border_top slds-p-top_small">
                <div class="slds-col">
                    <lightning-button 
                        label="Search" 
                        variant="brand" 
                        onclick={handleSearch} 
                        class="slds-size_1-of-1">
                    </lightning-button>
                </div>
                <div class="slds-col">
                    <lightning-button 
                        label="Reset" 
                        onclick={handleReset} 
                        class="slds-size_1-of-1">
                    </lightning-button>
                </div>
            </div>
        </div>
    </article>
</template>